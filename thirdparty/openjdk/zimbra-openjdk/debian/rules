#!/usr/bin/make -f
export DEB_BUILD_OPTIONS=nocheck 

%:
	dh $@

override_dh_auto_clean:

override_dh_auto_install:
	mkdir -p $(CURDIR)/debian/tmp/jvm
	tar -xvzf $(CURDIR)/../openjdk*.tgz -C $(CURDIR)/debian/tmp/jvm
	rm -rf $(CURDIR)/debian/tmp/bin
	mkdir -p $(CURDIR)/debian/tmp//opt/zimbra/common/bin
	mkdir -p $(CURDIR)/debian/tmp//opt/zimbra/common/lib
	mv $(CURDIR)/debian/tmp/jvm $(CURDIR)/debian/tmp/opt/zimbra/common/lib
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/lib/jvm && ln -s openjdk* java
	rm -rf $(CURDIR)/debian/tmp//opt/zimbra/common/lib/jvm/java/demo
	rm -rf $(CURDIR)/debian/tmp//opt/zimbra/common/lib/jvm/java/sample
	rm -f $(CURDIR)/debian/tmp//opt/zimbra/common/lib/jvm/java/lib/security/cacerts
	cd $(CURDIR)/debian/tmp//opt/zimbra/common/lib/jvm/java/lib/security && \
	ln -s /opt/zimbra/common/etc/java/cacerts cacerts
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/jar
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/java
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/javac
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/javap
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/jmap
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/jps
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/jstack
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/jstat
	cd $(CURDIR)/debian/tmp/opt/zimbra/common/bin && ln -s ../lib/jvm/java/bin/keytool
